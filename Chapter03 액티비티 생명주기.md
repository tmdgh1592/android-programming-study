# Chapter03 액티비티 생명주기

## 액티비티 상태와 생명주기 콜백

`Activity`의 모든 인스턴스는 생명주기를 갖는다. 그리고 생명주기 동안에 액티비티는 네 가지 상태로 상호 전환된다.

- 존재하지 않음(nonexistent)
- 중단(stopped)
- 일시 중지(paused)
- 실행 재개(resumed)

각 전환이 발생할 때 액티비티에 상태 변경을 알려주는 `Activity` 함수들이 있으며, 안드로이드가 자동으로 호출한다.

### 액티비티 상태 흐름

<img src="https://user-images.githubusercontent.com/39554623/117298233-18e4ed80-aeb2-11eb-9cc3-f4a0f93a3d0f.jpeg" width="500" height="500"/>

### 존재하지 않음(nonexistent)
액티비티가 아직 런칭되지 않았거나 소멸되었음을 나타낸다.
<br>
이 때문에 때로는 이상태를 `소멸(destroyed)` 상태라고도 한다.
<br>
이때 액티비티 인스턴스는 메모리에 존재하지 않으며, 사용자가 보거나 상호 작용하기 위한 뷰도 없다.

### 중단(stopped)
액티비티 인스턴스가 메모리에 있지만, 이것의 뷰는 화면에서 볼 수 없다는 것을 나타낸다.
<br>
액티비티가 처음 시작될 때 거쳐가는 상태이며, 액티비티 인스턴스의 뷰가 화면에서 완전히 가려졌을 때 언제든 다시 진입하는 상태다.

### 일시 중지(paused)
액티비티가 포그라운드에서 작동하진 않지만, 액티비티 인스턴스의 뷰 전체 또는 일부를 화면에서 볼 수 있음을 나타낸다.
<br>
만일 사용자가 분할 화면 모드로 두 개의 액티비티를 같이 보고 잇다면 액티비티 전체가 화면에 보일 수 있지만, 포그라운드에 존재하지 않을 수 있다.

### 실행 재개(resumed)
액티비티가 메모리에 있으면서 화면에서 전체를 볼 수 잇고 포그라운드에 있음을 나타낸다.
<br>
사용자가 현재 상호 작용하고 있는 액티비티가 바로 이 상태다.
<br>
`실행 재개`상태는 디바이스의 전체 시스템에 걸쳐 하나의 액티비티만 될 수 있다.
<br>
즉, 한 액티비티가 `실행 재개` 상태가 되면 직전에 실행 중이던 액티비티는 다른 상태로 바뀐다는 의미다.

`Activity`의 서브 클래스는 위 사진의 함수들을 사용해 액티비티 생명주기의 전환 시점에 필요한 일을 처리할 수 있다.
<br>
이 함수들을 `생명주기 콜백(lifecycle callback)`이라고 한다.

UI를 준비하기 위해 액티비티에서는 다음과 같이 `onCreate(Bundle?)`함수를 오버라이드한다.
1. 위젯을 인플레이트해 뷰 객체로 생성한 후 화면에 보여준다(setContentView(int)를 호출).
2. 인플레이트된 위젯의 객체 참조를 얻는다.사용자와의 상호 작용을 처리하기 위해 위젯에 리스너를 설정한다.
3. 사용자와의 상호 작용을 처리하기 위해 위젯에 리스너를 설정한다.
4. 외부의 모델 데이터를 연결한다.

## 장치 구성 변경과 액티비티 생명주기
장치를 회전하면 `장치 구성(device configuration)`이 변경된다. 장치 구성은 각 장치의 현재 상태를 나타내는 특성들의 집합이다.
대표적으로는 다음과 같다.
- 화면 방향
- 화면 밀도
- 화면 크기
- 키보드 타입
- 독 모드
- 다크 모드
- 언어 등

일반적으로 앱에서는 서로 다른 장치 구성에 맞추기 위해 대체 리소스를 제공한다.
<br>
`런타임 구성 변경(runtime configuration change)`이 생길 때는 새로운 구성에 더 잘맞는 리소스들이 있을 수 있다.
<br>
**따라서 안드로이드는 현재의 액티비티 인스턴스를 소멸시키고 새로운 구성에 가장 적합한 리소스를 찾는다.**
<br>
그리고 이 리소스를 사용해서 해당 액티비티의 새 인스턴스를 다시 빌드한다.

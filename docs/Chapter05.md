# 5️⃣ 안드로이드 앱의 디버깅

### 로그캣에서의 주 관심사 에러

- 대부분의 코드에서는 원인이 된 예외가 없는 마지막 예외가 문제가 발생한 곳이고 주 관심사다.
- 해당 예외 메세지는 메세지 앞에 `Caused by` 표시가 있다.
- 마지막 예외 바로 아래 줄이 스택 기록의 첫 번째 줄이다.
- 스택 기록의 첫 번째 줄에서는 예외가 발생했던 파일과 줄 번호는 물론이고 클래스와 함수도 알려준다.

### 오작동 진단하기

- 오작동의 경우, 예외를 발생시키지 않기 때문에 해결이 쉽지 않다.
- 오작동을 진단하는 방법에는 대표적으로 두 가지가 있다.
  - 스택 기록 로깅하기
    - `Log.d(String, String, Throwable)`을 사용하여 전체 스택 기록을 로깅할 수 있다.
    - 인자로 전달하는 예외는 이미 발생한 예외가 되면 안 되기 때문에 예외가 생성된 곳을 알기 위해서는 새로운 `Exception`을 생성해서 전달하면 된다.
    - 단점
      - 너무 메세지가 많고 길어서 알아보기 어렵다.
      - 기록이 쌓이는 것을 그대로 두면 로그캣의 메세지를 찾아보기도 어렵게 되고 누군가가 스택 기록을 보고 코드가 하는 일을 훔쳐볼 수도 있다.
  - 디버거를 사용한 중단점(breakpoint) 설정하기
    - 중단점은 설정된 해당 라인이 실행되기 전에 실행을 일시 중지시켜서 그다음부터 어떻게 실행되는지 코드를 한 줄씩 살펴볼 수 있게 해준다.
    - 디버거가 중단점을 처리하게 하려면 앱을 일반 실행 모드가 아닌 **디버깅 모드**로 실행되게 해야 한다.
    - 디버그 도구 창에는 프레임 뷰와 변수 뷰가 있다.
      - 변수 뷰의 첫 번째 줄에 있는 `this`를 확장하면 디버깅중인 객체 인스턴스가 갖고 있는 변수들을 볼 수 있다.
      - 또한 상위 객체의 모든 변수도 볼 수 있다.
    - 디버그 도구 창의 `Evaluate Expression` 버튼을 사용해서 디버깅 중에 간단한 코틀린 명령문(표현식)을 실행해볼 수도 있다.
    - 디버깅을 하면서 코드를 수정할 때는 디버깅을 중단해야 한다.
      - 그렇지 않으면 코드는 변경되지만 디버거로 실행되는 코드는 변경되기 전의 코드이므로 디버거가 잘못된 정보를 보여줄 수 있다.

### 안드로이드 Lint

- Lint는 안드로이드 코드의 **정적 분석기**다.
  - 정적 분석기란, 앱을 실행하지 않고 코드를 검사해 결함을 찾는 프로그램이다.
- Lint는 안드로이드 프레임워크에 관한 자신의 지식을 이용해 사전에 코드를 더 깊이 있게 살펴보고, 컴파일러가 알 수 없는 문제를 찾는다.
- Lint는 XML에 정의된 객체의 타입 검사도 할 수 있다.

### 프로파일러(profiler) 살펴보기

- 프로파일러 도구 창은 안드로이드 장치의 리소스(CPU, 메모리, 네트워크)를 앱이 어떻게 사용하고 있는지 그 상세 내역을 생성하고 보여준다.
- 따라서 앱의 성능을 측정하고 조정하는데 유용하다.